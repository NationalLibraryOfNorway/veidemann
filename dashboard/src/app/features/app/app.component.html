<div class="container mat-typography" fxLayout="column">
  @if (ability$ | async; as ability) {
  <ng-keyboard-shortcuts [shortcuts]="shortcuts"></ng-keyboard-shortcuts>
  <ng-keyboard-shortcuts-help class="keys" [keyDescription]="'Show this menu'" [keyLabel]="'General'"
    [key]="'shift + h'" [closeKeyDescription]="'Hide this help menu'" [closeKeyLabel]="'General'" [closeKey]="'escape'"
    [title]="'Keyboard shortcuts'">
  </ng-keyboard-shortcuts-help>
  <mat-toolbar class="main-toolbar" color="primary">
    <a routerLink="/"><img class="veidemann_logo" alt="Veidemann" src="../public/logo/veidemann_horizontal_white.png"></a>
    <span fxFlex></span>
    @if (ability.can('read', 'report')) {
    <button color="primary" mat-flat-button matTooltip="Click to show overview of scheduled crawljobs"
      i18n-matTooltip="@@mainToolbarScheduledCrawljobsButtonTooltip" (click)="onShowJobSchedule()">
      <app-time></app-time>
    </button>
    }
    <span fxFlex></span>
    <a mat-icon-button [matMenuTriggerFor]="helpMenu">
      <mat-icon>help</mat-icon>
    </a>
    <mat-menu #helpMenu="matMenu">
      <a mat-menu-item target="_blank" [routerLink]="['/docs']" [routerLinkActive]="['is-active']"
        [routerLinkActiveOptions]="{exact:true}">Docs</a>
      <a mat-menu-item (click)="onAbout()">About</a>
    </mat-menu>
    @if (!isLoggedIn) {
    <button color="primary" mat-flat-button (click)="onLogin()">
      <mat-icon>account_box</mat-icon>&nbsp;
      <span i18n="@@mainToolbarLoginButton">LOGIN</span>
    </button>
    }
    @if (isLoggedIn) {
    <button color="primary" mat-flat-button matTooltip="{{name}}" (click)="onLogout()">
      <mat-icon>account_box</mat-icon>&nbsp;
      <span i18n="@@mainToolbarLogoutButton">LOGOUT</span>
    </button>
    }
  </mat-toolbar>
  <nav mat-tab-nav-bar mat-stretch-tabs="false" [tabPanel]="tabPanel">
    @if (ability.can('read', 'configs')) {
    <a mat-tab-link [routerLink]="['/config']" routerLinkActive #config="routerLinkActive" [active]="config.isActive">
      <span i18n="@@mainMenuConfiguration">CONFIGURATION</span>
    </a>
    }
    @if (ability.can('read', 'report')) {
    <a mat-tab-link [routerLink]="['/report']" routerLinkActive #report="routerLinkActive" [active]="report.isActive">
      <span i18n="@@mainMenuReport">REPORT</span>
    </a>
    }
    @if (ability.can('read', 'logconfig')) {
    <a mat-tab-link [routerLink]="['/logconfig']" routerLinkActive #log="routerLinkActive" [active]="log.isActive">
      <span i18n="@@mainMenuLogConfiguration">LOG LEVEL</span>
    </a>
    }
  </nav>
  @if (isModuleLoading$ | async) {
  <div class="module-loader">
    <h2 i18n="@@appModuleLoadingText">Loading module...</h2>
    <mat-spinner [strokeWidth]="2"></mat-spinner>
  </div>
  }
  <app-dialog></app-dialog>
  <main fxFlex>
    <mat-tab-nav-panel #tabPanel>
      <router-outlet></router-outlet>
    </mat-tab-nav-panel>
  </main>
  }
</div>
